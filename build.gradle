/*
 * This build file was generated by the Gradle 'init' task.
 *
 * This generated file contains a sample Java Library project to get you started.
 * For more details take a look at the Java Libraries chapter in the Gradle
 * user guide available at https://docs.gradle.org/4.2.1/userguide/java_library_plugin.html
 */

version="SPARK-3.5.0"

buildscript {
   repositories {
      mavenLocal()
      mavenCentral()
      maven { url "https://plugins.gradle.org/m2/" }
   }
}

apply plugin: 'java-library'
apply plugin: 'java'
apply plugin: 'scala'
apply plugin: 'application'

repositories {
    jcenter()
    mavenCentral()
    maven { url 'https://jitpack.io' }
}

dependencies {
    compileOnly project(':fractal-core')
    compileOnly project(':fractal-apps')
}

task scalaTest(dependsOn: ['testClasses'], type: JavaExec) {
  environment "SPARK_SCALA_VERSION", "2.13"
  main = 'org.scalatest.tools.Runner'
  args = ['-R', 'build/classes/scala/test', '-o']
  classpath = sourceSets.test.runtimeClasspath
}

application {
    applicationDefaultJvmArgs = ['-Xmx10g']
    mainClassName = project.hasProperty("mainClass") ? getProperty("mainClass") : "NULL"
}

subprojects {
   apply plugin: 'java-library'
   apply plugin: 'java'
   apply plugin: 'scala'

   task scalaTest(dependsOn: ['testClasses'], type: JavaExec) {
      environment "SPARK_SCALA_VERSION", "2.13"
      main = 'org.scalatest.tools.Runner'
      args = ['-R', 'build/classes/scala/test', '-o']
      classpath = sourceSets.test.runtimeClasspath
   }

   test.dependsOn scalaTest
}
